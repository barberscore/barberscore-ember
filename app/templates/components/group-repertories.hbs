<div class='table-responsive'>
  <table class='table'>
    <thead>
      <tr>
        <th class='col-md-6'>Title</th>
        <th class='col-md-5'>Arranger(s)</th>
        <th class='col-md-1'>Delete</th>
      </tr>
    </thead>
    <tbody>
      {{#each sortedRepertories as |repertory|}}
        <tr>
          {{#if repertory.chart.isLoading}}
            <td colspan=2>Loading&nbsp;{{fa-icon 'spinner' spin=true}}</td>
          {{else}}
            <td>{{repertory.chart.title}}</td>
            <td>{{repertory.chart.arrangers}}</td>
            <td>
              {{#bs-button type='danger' size='xs' onClick=(perform deleteRepertory repertory) disabled=isDisabled}}Delete{{/bs-button}}
            </td>
          {{/if}}
        </tr>
      {{else}}
        <tr>
          <td>
            No songs in Repertory.
          </td>
        </tr>
      {{/each}}
    </tbody>
  </table>
  <div>
    <p>
    {{#bs-button type='success' disabled=isDisabled onClick=(action (mut createRepertoryModal) true)}}Add New Chart{{/bs-button}}
    </p>
  </div>
  <p>
    {{#bs-button class='btn btn-link' onClick=(toggle 'customCollapsed' this)}}
      Have a new custom chart or parody? Or is your chart not showing up in your search? Click Here.
    {{/bs-button}}
  </p>
  {{#bs-collapse collapsed=customCollapsed}}
    <p>
      We have many of the common charts already in the system. If you have a well-known chart that isn't showing up in your search, try a few variations such as entering just one or two words (instead of the whole title), or try searching on just the arranger's name. Also, just type in a word or two, then pause (don't press Enter)... the search executes automatically after you type in a few letters.
    </p>
    <p>If you intend to perform a parody of an existing chart, DO NOT add the original chart to your repertory. Instead, follow the process outlined below to have us add it as a "custom" chart. We will append "(Parody)" to the original title to distinguish it appropriately and add it to your repertory.</p>
    <p>
      If you have a new custom arrangement or parody - (or you can't find your chart despite your best efforts) - then you must send a copy of the sheet music or an image of the first page (with the title, arranger, composer, and copyright info clearly visible) to <a href="mailto:charts@barberscore.com">charts@barberscore.com</a>. Our datamaster will get the information into the system as quickly as possible -- usually in less than 24 hours -- and add it to your repertory for you. If this chart is private or exclusive for your group, please indicate as such in your email, and we will mark it as "protected" in the Barberscore database.
    </p>
  {{/bs-collapse}}
</div>
<div>
  {{#bs-modal
    open=createRepertoryModal
    onHidden=(pipe-action (action (mut createRepertoryModal) false) (action (mut createRepertoryModalError) false))
    as |modal|
  }}
    {{#modal.header}}
      <h4>Add New Chart to Repertory</h4>
    {{/modal.header}}
    {{#modal.body}}
      <p>
        Please select a chart to add.
      </p>
      {{#power-select
        search=(perform searchChart)
        selected=chart
        onchange=(action (mut chart))
        placeholder="Type in a partial title or arranger name"
        allowClear=true
        renderInPlace=true
        noMatchesMessage="No charts found matching the search text. Try typing a partial title"
        as |chart|
      }}
        Song: {{chart.title}} [{{chart.arrangers}}]
      {{/power-select}}
      {{#if createRepertoryModalError}}
      <p class='text-danger'>
        Could not delete chart.  Please contact support.
      </p>
      {{/if}}
    {{/modal.body}}
    {{#modal.footer}}
      {{#bs-button onClick=(action modal.close) type="default"}}Cancel{{/bs-button}}
      {{#bs-button type='success' onClick=(perform saveRepertory chart) disabled=isDisabled}}
        {{#if saveRepertory.isRunning}}
          Adding... {{fa-icon "spinner" spin=true}}
        {{else}}
          Add Chart
        {{/if}}
      {{/bs-button}}
    {{/modal.footer}}
  {{/bs-modal}}
</div>

